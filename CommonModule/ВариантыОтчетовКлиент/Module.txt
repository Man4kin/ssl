////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
// МОДУЛЬ СОДЕРЖИТ КЛИЕНТСКИЕ ПРОЦЕДУРЫ ПОДСИСТЕМЫ "ВАРИАНТЫ ОТЧЕТОВ"

// Процедура открывает панель отчетов. Используется в модуле общей команды.
// Параметры:
//		Подсистемы                 - строка с путем к подсистеме
//		НазваниеФормы              - заголовок панели отчетов должен соответствовать представление команды
//      ПараметрыВыполненияКоманды - Параметры выполнения команды
//		КартинкаФормы              - картинка возле заголовка панели.
//
Процедура ОткрытьПанельОтчетов(Подсистемы, НазваниеФормы, ПараметрыВыполненияКоманды, КартинкаФормы = Неопределено) Экспорт
	
	ПараметрыФормы = Новый Структура("Подсистемы, ИмяФормы, КартинкаФормы");
	ПараметрыФормы.Подсистемы    = Подсистемы;
	ПараметрыФормы.ИмяФормы      = НазваниеФормы;
	ПараметрыФормы.КартинкаФормы = КартинкаФормы;
	ОткрытьФорму("ОбщаяФорма.ПанельОтчетов", ПараметрыФормы, ПараметрыВыполненияКоманды.Источник, ПараметрыВыполненияКоманды.Уникальность, ПараметрыВыполненияКоманды.Окно);
	
КонецПроцедуры


// Восстанавливает из переданной строки запрещенные символы в именах элементов формы
//
Функция ВосстановитьЗапрещенныеСимволы(Знач СтрокаДляЗамены) Экспорт
	
	СтрокаРезультат = СтрокаДляЗамены;
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Точка_", ".");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Зап_", ",");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Слэш_", "\");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Тирэ_", "-");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_П_", " ");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Воскл_", "!");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Соб_", "@");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Ном_", "№");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Проц_", "%");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Реш_", "#");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Дол_", "$");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Степ_", "^");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Анд_", "&");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ТЗап_", ";");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ДвТ_", ":");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Воп_", "?");
   	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Звезд_", "*");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ОСк_", "(");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ЗСк_", ")");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Рав_", "=");

	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Вол_", "~");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Ап_", "`");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ОФС_", "{");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ЗФС_", "{");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ОКС_", "[");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ЗКС_", "[");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Кав_", """");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ОКав_", "'");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Пал_", "|");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ПСл_", "\");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_ОСл_", "/");
	
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Бол_", ">");
	СтрокаРезультат = СтрЗаменить(СтрокаРезультат, "_Мен_", "<");
	
	Возврат СтрокаРезультат;
	
КонецФункции


// Процедура вызывается для стыковки с другими подсистемами
// Возвращает параметры дополнительной команды
// Параметры:
//		ЗначениеПараметровКоманд - таблица из формы "Панель отчетов" или "Все отчеты".
//		МассивПараметровКомманд  - Фиксированный массив из формы "Все отчеты" или "Панель отчетов"
//		Ключ                     - уникальный ключ команды
//
Функция ПолучитьПараметрыКоманды(ЗначениеПараметровКоманд, МассивПараметровКоманд, Ключ) Экспорт
	
	Для Каждого СтрокаПараметра из ЗначениеПараметровКоманд Цикл
		Если СтрокаПараметра.Ключ = Ключ Тогда
			Возврат МассивПараметровКоманд[СтрокаПараметра.ИндексПозицииЭлемента];
		КонецЕсли;
	КонецЦикла;
	Возврат Неопределено;
	
КонецФункции

